<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EmailJS Deep Debug</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        h1, h2, h3 {
            color: #333;
        }
        pre {
            background-color: #f5f5f5;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }
        .card {
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 20px;
            background-color: #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #45a049;
        }
        input, textarea {
            width: 100%;
            padding: 8px;
            margin: 5px 0 15px 0;
            display: inline-block;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .log-container {
            height: 200px;
            overflow-y: auto;
            background-color: #f9f9f9;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .parameter-section {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        .parameter-box {
            flex: 1;
            min-width: 200px;
            padding: 10px;
            background-color: #f0f7ff;
            border-radius: 5px;
            border: 1px solid #d0e4ff;
        }
        #template-fields {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        #template-fields th, #template-fields td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        #template-fields th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        .test-result {
            display: none;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <h1>EmailJS Deep Debugging Tool</h1>
    <p>This tool helps diagnose issues with EmailJS configuration and email delivery.</p>

    <div class="card">
        <h2>Step 1: Verify EmailJS Library</h2>
        <div id="library-status">Checking EmailJS library status...</div>
        <button id="init-emailjs">Manually Initialize EmailJS</button>
    </div>

    <div class="card">
        <h2>Step 2: Check Your EmailJS Configuration</h2>
        <div class="form-group">
            <label for="service-id">Service ID:</label>
            <input type="text" id="service-id" value="service_eh0jpbf">
        </div>
        <div class="form-group">
            <label for="template-id">Template ID:</label>
            <input type="text" id="template-id" value="template_pplvcfl">
        </div>
        <div class="form-group">
            <label for="public-key">Public Key:</label>
            <input type="text" id="public-key" value="zxeSmFLK-CuHM_mKO">
        </div>
        <button id="test-config">Test Configuration</button>
        <div id="config-result" class="test-result"></div>
    </div>

    <div class="card">
        <h2>Step 3: Test Your Template Fields</h2>
        <p>This will check what parameters your template is expecting.</p>
        
        <table id="template-fields">
            <tr>
                <th>Field</th>
                <th>Value to Test</th>
                <th>Expected Parameter</th>
            </tr>
            <tr>
                <td>To Email</td>
                <td><input type="email" id="test-to-email" value="csorini13@gmail.com"></td>
                <td>
                    <select id="to-email-param">
                        <option value="to_email">to_email</option>
                        <option value="recipient">recipient</option>
                        <option value="toEmail">toEmail</option>
                        <option value="email_to">email_to</option>
                        <option value="destination">destination</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>From Name</td>
                <td><input type="text" id="test-from-name" value="Test Sender"></td>
                <td>
                    <select id="from-name-param">
                        <option value="from_name">from_name</option>
                        <option value="fromName">fromName</option>
                        <option value="sender_name">sender_name</option>
                        <option value="name">name</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>Reply To</td>
                <td><input type="email" id="test-reply-to" value="test@example.com"></td>
                <td>
                    <select id="reply-to-param">
                        <option value="reply_to">reply_to</option>
                        <option value="replyTo">replyTo</option>
                        <option value="reply_email">reply_email</option>
                        <option value="email">email</option>
                    </select>
                </td>
            </tr>
        </table>
        <button id="test-fields">Test Template Fields</button>
        <div id="fields-result" class="test-result"></div>
    </div>

    <div class="card">
        <h2>Step 4: Send Test Emails</h2>
        <div class="parameter-section">
            <div class="parameter-box">
                <h3>Standard Parameters</h3>
                <button id="send-standard">Send With Standard Params</button>
                <pre>
{
  name: "Test User",
  email: "test@example.com",
  subject: "Test Subject",
  message: "Test Message",
  to_name: "Christopher Sorini",
  to_email: "csorini13@gmail.com",
  from_name: "Test User",
  reply_to: "test@example.com"
}</pre>
            </div>
            <div class="parameter-box">
                <h3>Alternative Parameters</h3>
                <button id="send-alt">Send With Alt Params</button>
                <pre>
{
  name: "Test User",
  email: "test@example.com",
  subject: "Test Subject",
  message: "Test Message",
  to_name: "Christopher Sorini",
  recipient: "csorini13@gmail.com",
  fromName: "Test User",
  replyTo: "test@example.com"
}</pre>
            </div>
            <div class="parameter-box">
                <h3>Multiple Parameters</h3>
                <button id="send-multiple">Send With Multiple Params</button>
                <pre>
{
  name: "Test User",
  email: "test@example.com",
  subject: "Test Subject",
  message: "Test Message",
  to_name: "Christopher Sorini",
  to_email: "csorini13@gmail.com",
  recipient: "csorini13@gmail.com",
  toEmail: "csorini13@gmail.com",
  email_to: "csorini13@gmail.com",
  destination: "csorini13@gmail.com",
  from_name: "Test User",
  reply_to: "test@example.com"
}</pre>
            </div>
        </div>
        <div id="send-result" class="test-result"></div>
    </div>

    <div class="card">
        <h2>Debugging Log</h2>
        <div id="log" class="log-container"></div>
        <button id="clear-log">Clear Log</button>
    </div>

    <!-- Include EmailJS directly from jsDelivr CDN (recommended by EmailJS) -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    
    <script>
        // Logging function
        function logMessage(message, isError = false) {
            const logElement = document.getElementById('log');
            const logEntry = document.createElement('div');
            const timestamp = new Date().toLocaleTimeString();
            
            logEntry.innerHTML = `<strong>[${timestamp}]</strong> ${message}`;
            logEntry.style.color = isError ? '#721c24' : 'inherit';
            
            logElement.appendChild(logEntry);
            logElement.scrollTop = logElement.scrollHeight;
            
            // Also log to console
            if (isError) {
                console.error(message);
            } else {
                console.log(message);
            }
        }

        // Function to show test results
        function showResult(elementId, message, isError = false) {
            const element = document.getElementById(elementId);
            element.className = isError ? 'test-result error' : 'test-result success';
            element.textContent = message;
            element.style.display = 'block';
        }

        // Document ready function
        document.addEventListener('DOMContentLoaded', function() {
            // Check EmailJS library status
            const libraryStatus = document.getElementById('library-status');
            if (typeof emailjs !== 'undefined') {
                libraryStatus.className = 'success';
                libraryStatus.textContent = 'EmailJS library loaded successfully!';
                logMessage('EmailJS library detected on page load');
                
                // Initialize EmailJS
                try {
                    emailjs.init("zxeSmFLK-CuHM_mKO");
                    logMessage('EmailJS initialized with public key: zxeSmFLK-CuHM_mKO');
                } catch (error) {
                    libraryStatus.className = 'error';
                    libraryStatus.textContent = 'Error initializing EmailJS: ' + error.message;
                    logMessage('Error initializing EmailJS: ' + error.message, true);
                }
            } else {
                libraryStatus.className = 'error';
                libraryStatus.textContent = 'EmailJS library not loaded!';
                logMessage('EmailJS library not detected on page load', true);
            }

            // Manual initialize button
            document.getElementById('init-emailjs').addEventListener('click', function() {
                const publicKey = document.getElementById('public-key').value.trim();
                
                if (typeof emailjs !== 'undefined') {
                    try {
                        emailjs.init(publicKey);
                        libraryStatus.className = 'success';
                        libraryStatus.textContent = 'EmailJS manually initialized with key: ' + publicKey;
                        logMessage('EmailJS manually initialized with key: ' + publicKey);
                    } catch (error) {
                        libraryStatus.className = 'error';
                        libraryStatus.textContent = 'Manual initialization failed: ' + error.message;
                        logMessage('Manual initialization failed: ' + error.message, true);
                    }
                } else {
                    libraryStatus.className = 'error';
                    libraryStatus.textContent = 'EmailJS library not available for manual initialization!';
                    logMessage('EmailJS library not available for manual initialization', true);
                }
            });

            // Test config button
            document.getElementById('test-config').addEventListener('click', function() {
                const serviceId = document.getElementById('service-id').value.trim();
                const templateId = document.getElementById('template-id').value.trim();
                const publicKey = document.getElementById('public-key').value.trim();
                
                logMessage(`Testing configuration with Service ID: ${serviceId}, Template ID: ${templateId}`);
                
                // Simple configuration test using a minimal data object
                const testData = {
                    test_param: 'Configuration Test',
                    timestamp: new Date().toISOString()
                };
                
                try {
                    emailjs.send(serviceId, templateId, testData)
                        .then(function(response) {
                            logMessage(`Configuration test successful! Response: ${JSON.stringify(response)}`);
                            showResult('config-result', 'Configuration test successful! This means your service ID and template ID are valid.', false);
                        })
                        .catch(function(error) {
                            logMessage(`Configuration test failed: ${JSON.stringify(error)}`, true);
                            showResult('config-result', `Configuration test failed: ${error.text || 'Unknown error'}`, true);
                        });
                } catch (error) {
                    logMessage(`Error sending test: ${error.message}`, true);
                    showResult('config-result', `Error sending test: ${error.message}`, true);
                }
            });

            // Test template fields button
            document.getElementById('test-fields').addEventListener('click', function() {
                const serviceId = document.getElementById('service-id').value.trim();
                const templateId = document.getElementById('template-id').value.trim();
                
                // Get test values and parameter names
                const toEmail = document.getElementById('test-to-email').value.trim();
                const fromName = document.getElementById('test-from-name').value.trim();
                const replyTo = document.getElementById('test-reply-to').value.trim();
                
                const toEmailParam = document.getElementById('to-email-param').value;
                const fromNameParam = document.getElementById('from-name-param').value;
                const replyToParam = document.getElementById('reply-to-param').value;
                
                logMessage(`Testing template fields with parameters: ${toEmailParam}="${toEmail}", ${fromNameParam}="${fromName}", ${replyToParam}="${replyTo}"`);
                
                // Create test data object
                const testData = {
                    subject: 'Template Field Test',
                    message: 'This is a test to verify which template fields are being used correctly.',
                };
                
                // Add the parameters dynamically
                testData[toEmailParam] = toEmail;
                testData[fromNameParam] = fromName;
                testData[replyToParam] = replyTo;
                
                try {
                    emailjs.send(serviceId, templateId, testData)
                        .then(function(response) {
                            logMessage(`Template field test successful! Response: ${JSON.stringify(response)}`);
                            showResult('fields-result', `Email sent with parameters: ${toEmailParam}, ${fromNameParam}, ${replyToParam}. Check your inbox at ${toEmail}!`, false);
                        })
                        .catch(function(error) {
                            logMessage(`Template field test failed: ${JSON.stringify(error)}`, true);
                            showResult('fields-result', `Template field test failed: ${error.text || 'Unknown error'}`, true);
                        });
                } catch (error) {
                    logMessage(`Error sending template field test: ${error.message}`, true);
                    showResult('fields-result', `Error sending template field test: ${error.message}`, true);
                }
            });

            // Send with standard parameters
            document.getElementById('send-standard').addEventListener('click', function() {
                const serviceId = document.getElementById('service-id').value.trim();
                const templateId = document.getElementById('template-id').value.trim();
                
                const standardData = {
                    name: "Test User",
                    email: "test@example.com",
                    subject: "Standard Parameters Test",
                    message: "This test uses the standard parameter names from your original code.",
                    to_name: "Christopher Sorini",
                    to_email: "csorini13@gmail.com",
                    from_name: "Test User",
                    reply_to: "test@example.com"
                };
                
                logMessage(`Sending email with standard parameters: ${JSON.stringify(standardData)}`);
                
                try {
                    emailjs.send(serviceId, templateId, standardData)
                        .then(function(response) {
                            logMessage(`Standard parameters test successful! Response: ${JSON.stringify(response)}`);
                            showResult('send-result', 'Email with standard parameters sent successfully! Check your inbox.', false);
                        })
                        .catch(function(error) {
                            logMessage(`Standard parameters test failed: ${JSON.stringify(error)}`, true);
                            showResult('send-result', `Standard parameters test failed: ${error.text || 'Unknown error'}`, true);
                        });
                } catch (error) {
                    logMessage(`Error sending standard parameters test: ${error.message}`, true);
                    showResult('send-result', `Error sending standard parameters test: ${error.message}`, true);
                }
            });

            // Send with alternative parameters
            document.getElementById('send-alt').addEventListener('click', function() {
                const serviceId = document.getElementById('service-id').value.trim();
                const templateId = document.getElementById('template-id').value.trim();
                
                const altData = {
                    name: "Test User",
                    email: "test@example.com",
                    subject: "Alternative Parameters Test",
                    message: "This test uses alternative parameter names that might be expected by your template.",
                    to_name: "Christopher Sorini",
                    recipient: "csorini13@gmail.com",
                    fromName: "Test User",
                    replyTo: "test@example.com"
                };
                
                logMessage(`Sending email with alternative parameters: ${JSON.stringify(altData)}`);
                
                try {
                    emailjs.send(serviceId, templateId, altData)
                        .then(function(response) {
                            logMessage(`Alternative parameters test successful! Response: ${JSON.stringify(response)}`);
                            showResult('send-result', 'Email with alternative parameters sent successfully! Check your inbox.', false);
                        })
                        .catch(function(error) {
                            logMessage(`Alternative parameters test failed: ${JSON.stringify(error)}`, true);
                            showResult('send-result', `Alternative parameters test failed: ${error.text || 'Unknown error'}`, true);
                        });
                } catch (error) {
                    logMessage(`Error sending alternative parameters test: ${error.message}`, true);
                    showResult('send-result', `Error sending alternative parameters test: ${error.message}`, true);
                }
            });

            // Send with multiple parameters
            document.getElementById('send-multiple').addEventListener('click', function() {
                const serviceId = document.getElementById('service-id').value.trim();
                const templateId = document.getElementById('template-id').value.trim();
                
                const multipleData = {
                    name: "Test User",
                    email: "test@example.com",
                    subject: "Multiple Parameters Test",
                    message: "This test includes multiple variations of parameter names to cover all possibilities.",
                    to_name: "Christopher Sorini",
                    to_email: "csorini13@gmail.com",
                    recipient: "csorini13@gmail.com",
                    toEmail: "csorini13@gmail.com",
                    email_to: "csorini13@gmail.com",
                    destination: "csorini13@gmail.com",
                    from_name: "Test User",
                    reply_to: "test@example.com"
                };
                
                logMessage(`Sending email with multiple parameters: ${JSON.stringify(multipleData)}`);
                
                try {
                    emailjs.send(serviceId, templateId, multipleData)
                        .then(function(response) {
                            logMessage(`Multiple parameters test successful! Response: ${JSON.stringify(response)}`);
                            showResult('send-result', 'Email with multiple parameters sent successfully! Check your inbox.', false);
                        })
                        .catch(function(error) {
                            logMessage(`Multiple parameters test failed: ${JSON.stringify(error)}`, true);
                            showResult('send-result', `Multiple parameters test failed: ${error.text || 'Unknown error'}`, true);
                        });
                } catch (error) {
                    logMessage(`Error sending multiple parameters test: ${error.message}`, true);
                    showResult('send-result', `Error sending multiple parameters test: ${error.message}`, true);
                }
            });

            // Clear log button
            document.getElementById('clear-log').addEventListener('click', function() {
                document.getElementById('log').innerHTML = '';
                logMessage('Log cleared');
            });
        });
    </script>
</body>
</html> 